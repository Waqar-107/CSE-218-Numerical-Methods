%driver program to run and plot 
%Euler, Heun,Midpoint and Ralston's method

clear;
clc;

fx=@(x) (-2*(x.^3) + 12*(x.^2) - 20*x +8.5);
fx2=@(x) (-0.5*(x.^4) + 4*(x.^3) -10*(x.^2) + 8.5*x +1);

xi=0;yi=1;
xs=0;xf=4;
h=0.5;

grid on;
hold on;



%--------------------------------------------------------------------
x_true=xs:h:xf;
y_true=fx2(x_true);
plot(x_true,y_true,'k');
%--------------------------------------------------------------------


%--------------------------------------------------------------------
x_euler=xs:h:xf;
disp('----------------------------------------------------');
disp('Euler');
y_euler=s1505107_Euler(fx,fx2,xi,yi,xs,xf,h);
disp('----------------------------------------------------');

plot(x_euler,y_euler,'r');
%plot(x_euler,y_euler,'b*');
%--------------------------------------------------------------------


%--------------------------------------------------------------------
x_heun=xs:h:xf;
disp('----------------------------------------------------');
disp('Heun');
y_heun=s1505107_Heun(fx,fx2,xi,yi,xs,xf,h);
disp('----------------------------------------------------');

plot(x_heun,y_heun,'b');
%plot(x_heun,y_heun,'r*');
%--------------------------------------------------------------------


%--------------------------------------------------------------------
x_mid=xs:h:xf;
disp('----------------------------------------------------');
disp('Midpoint');
y_mid=s1505107_Midpoint(fx,fx2,xi,yi,xs,xf,h);
disp('----------------------------------------------------');

plot(x_mid,y_mid,'c');
%plot(x_mid,y_mid,'k*');
%--------------------------------------------------------------------


%--------------------------------------------------------------------
x_rals=xs:h:xf;
disp('----------------------------------------------------');
disp('Ralston');
y_rals=s1505107_Ralston(fx,fx2,xi,yi,xs,xf,h);
disp('----------------------------------------------------');

plot(x_rals,y_rals,'g');
%plot(x_rals,y_rals,'k*');
%--------------------------------------------------------------------

legend('True','Euler','Heun','Midpoint','Ralston');
